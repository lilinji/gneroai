---
title: 🧬 Alphafold 2 使用方法
sidebar_position: 3
description: >-
  Protein structure prediction using AlphaFold 2 on HPC systems.
---

# 🧬 Alphafold 2 使用方法

AlphaFold 2 是 DeepMind 开发的基于人工智能的蛋白质三维结构预测工具，极大推动了结构生物学和生命科学研究。其在 HPC 集群上运行时，通常需要 GPU 支持和大量内存。

---

## 目录
- [AlphaFold 2 简介](#alphafold-2-简介)
- [环境准备](#环境准备)
- [GPU 作业脚本示例](#gpu-作业脚本示例)
- [任务提交与结果查看](#任务提交与结果查看)
- [常见问题与排查](#常见问题与排查)
- [参考资料](#参考资料)
- [动画演示](#动画演示)

---

## AlphaFold 2 简介

- **AlphaFold 2** 能精准预测蛋白质三维结构，广泛应用于结构生物学、药物设计等领域。
- 依赖 GPU 计算资源，推荐使用 16GB 及以上显存的 GPU。
- 运行前需准备好数据库（如 UniRef90、MGnify、PDB70、BFD、Uniclust30、PDB、PDB seqres、模板等）。

---

## 环境准备

1. **数据库准备**
   - 数据库路径如 `/hpcfs/fpublic/database/alphafold/data4run`，请联系管理员或参考平台说明。
2. **软件环境**
   - 推荐使用官方或平台提供的 Conda 环境，如 `/hpcfs/fpublic/app/anaconda3/envs/env_af2`。
   - 需包含 Python 3.7+、CUDA 驱动、AlphaFold 2 及其依赖。
3. **脚本与输入文件**
   - 预测脚本如 `/hpcfs/fpublic/aiapp/alphafold/run_alphafold.sh`
   - 输入为标准 FASTA 格式的蛋白质序列文件

---

## GPU 作业脚本示例

以下为典型的 Slurm 作业脚本 `job.slurm`，请根据实际情况修改中文注释部分：

```bash
#!/bin/bash
#SBATCH -J af2_AH3                # 作业名称
#SBATCH -p qgpu_3090              # GPU分区名称
#SBATCH -N 1                      # 节点数
#SBATCH -n 16                     # 总核数
#SBATCH -o job_%j.out             # 标准输出
#SBATCH -e job_%j.err             # 错误输出
#SBATCH --gres=gpu:1              # 申请1块GPU
#SBATCH --mem=32G                 # 内存
#SBATCH --mail-type=end           # 邮件通知
#SBATCH --mail-user=你的邮箱地址   # 邮箱地址

# 输出作业和节点信息
 echo "run [job_${SLURM_JOB_ID}] on [node_${SLURM_JOB_NODELIST}]"

# 激活conda环境
source /etc/profile.d/conda.sh
conda activate /hpcfs/fpublic/app/anaconda3/envs/env_af2

# 切换到AlphaFold目录
cd /hpcfs/fpublic/aiapp/alphafold

# 运行预测脚本
bash /hpcfs/fpublic/aiapp/alphafold/run_alphafold.sh \
  -d /hpcfs/fpublic/database/alphafold/data4run \
  -o 放预测结果的全路径文件夹 \
  -f 需要预测的fasta文件.fasta \
  -t 2022-05-14
```

<aside>
💡 **注意：必须根据自己的实际情况更改上面脚本中中文标注的地方后，作业才可以正常提交**
</aside>

---

## 任务提交与结果查看

1. **提交作业**

```bash
sbatch job.slurm
```

2. **查看作业状态**

```bash
squeue -u $USER
```

3. **查看输出结果**

- 预测结果、日志等会输出到你指定的 `-o` 目录和 `job_%j.out` 文件中。
- 典型输出包括 `result_model_*.pdb`、`ranking_debug.json`、`log.txt` 等。

---

## 动画演示


![alphafold2.gif](/static/guides/hpc/software-applications/alphafold2.gif)

---

## 常见问题与排查

### 1. 作业提交后长时间排队
- 检查 GPU 分区资源是否紧张，可尝试更换分区或调整资源参数

### 2. 作业报错“CUDA out of memory”
- 检查 GPU 显存是否足够，减少 batch size 或更换更大显存的 GPU

### 3. 数据库路径/FASTA 文件找不到
- 检查路径拼写，确保数据库和输入文件存在且有权限访问

### 4. 依赖包/环境问题
- 确认 conda 环境已激活，依赖包齐全

### 5. 预测结果异常或为空
- 检查输入序列格式、日志文件，必要时联系管理员

---

## 参考资料
- [AlphaFold 2 官方文档](https://github.com/deepmind/alphafold)
- [Slurm 官方文档](https://slurm.schedmd.com/documentation.html)
- [HPC Best Practices](https://docs.nersc.gov/applications/biology/alphafold/)

---

<head>
  <title>Alphafold 2 使用方法 Guide</title>
  <meta
    name="description"
    content="Protein structure prediction using AlphaFold 2 on HPC systems."
  />
</head> 