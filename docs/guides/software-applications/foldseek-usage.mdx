---
title: ğŸ” Foldseek è›‹ç™½è´¨ç»“æ„æœç´¢å¹³å°ä½¿ç”¨æŒ‡å—
sidebar_position: 9
description: >-
  å…¨é¢çš„Foldseekè›‹ç™½è´¨ç»“æ„æœç´¢å·¥å…·ä½¿ç”¨æŒ‡å—ï¼Œæ¶µç›–å›¾å½¢åŒ–ç•Œé¢å’Œå‘½ä»¤è¡Œä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼ŒåŒ…å«ç»“æ„æ¯”å¯¹ã€æ•°æ®åº“æœç´¢å’Œç»“æœåˆ†æçš„å®Œæ•´æµç¨‹ã€‚
  Comprehensive guide for Foldseek protein structure search tool covering both GUI and CLI approaches, including structure alignment, database search and result analysis.
tags: [Foldseek, è›‹ç™½è´¨ç»“æ„, ç»“æ„æ¯”å¯¹, ç»“æ„æœç´¢, AlphaFold, PDB]
---

# ğŸ” Foldseek è›‹ç™½è´¨ç»“æ„æœç´¢å¹³å°ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

**Foldseek** æ˜¯ä¸€æ¬¾é©å‘½æ€§çš„è›‹ç™½è´¨ç»“æ„æ¯”å¯¹å’Œæœç´¢å·¥å…·ï¼Œä¸“ä¸ºå¤§è§„æ¨¡è›‹ç™½è´¨ç»“æ„æ•°æ®åº“çš„é«˜æ•ˆæœç´¢è€Œè®¾è®¡ã€‚ä½œä¸ºç»“æ„ç”Ÿç‰©å­¦å’Œè¯ç‰©å‘ç°é¢†åŸŸçš„é‡è¦å·¥å…·ï¼ŒFoldseek èƒ½å¤Ÿåœ¨å‡ ç§’é’Ÿå†…æœç´¢åŒ…å«æ•°ç™¾ä¸‡ç»“æ„çš„æ•°æ®åº“ï¼Œä¸ºè›‹ç™½è´¨åŠŸèƒ½æ³¨é‡Šã€è¿›åŒ–åˆ†æå’Œè¯ç‰©é¶ç‚¹å‘ç°æä¾›å¼ºæœ‰åŠ›çš„æ”¯æŒã€‚

**Foldseek** is a revolutionary protein structure alignment and search tool designed for efficient searching of large-scale protein structure databases. As an important tool in structural biology and drug discovery, Foldseek can search databases containing millions of structures within seconds, providing powerful support for protein functional annotation, evolutionary analysis, and drug target discovery.

:::info æ ¸å¿ƒä¼˜åŠ¿
- **è¶…é«˜é€Ÿæœç´¢**ï¼šæ¯”ä¼ ç»Ÿç»“æ„æ¯”å¯¹å·¥å…·å¿«10,000å€
- **å¤§è§„æ¨¡æ”¯æŒ**ï¼šèƒ½å¤Ÿæœç´¢AlphaFoldã€PDBç­‰å¤§å‹ç»“æ„æ•°æ®åº“
- **é«˜çµæ•åº¦**ï¼šæ£€æµ‹è¿œç¨‹åŒæºæ€§å’Œç»“æ„ç›¸ä¼¼æ€§
- **å¤šç§æœç´¢æ¨¡å¼**ï¼šæ”¯æŒç»“æ„-ç»“æ„ã€åºåˆ—-ç»“æ„ç­‰å¤šç§æ¯”å¯¹æ¨¡å¼
:::

---

## å¿«é€Ÿå¯¼èˆª

ç›®å½•å†…å®¹è¯·å‚è€ƒé¡µé¢å„ç« èŠ‚æ ‡é¢˜ã€‚

---

## ğŸš€ è½¯ä»¶ç‰¹æ€§ä¸åº”ç”¨

### æ ¸å¿ƒåŠŸèƒ½ç‰¹ç‚¹

| åŠŸèƒ½ç‰¹æ€§ | æè¿° | åº”ç”¨åœºæ™¯ |
|---------|-----|---------|
| **å¿«é€Ÿç»“æ„æœç´¢** | æ¯«ç§’çº§ç»“æ„æ•°æ®åº“æœç´¢ | åŒæºè›‹ç™½æ£€ç´¢ã€åŠŸèƒ½é¢„æµ‹ |
| **å¤šæ•°æ®åº“æ”¯æŒ** | PDBã€AlphaFoldã€SwissProtç­‰ | å…¨é¢çš„ç»“æ„æ¯”è¾ƒåˆ†æ |
| **çµæ•åº¦ä¼˜åŒ–** | æ£€æµ‹å¾®å¼±ç»“æ„ç›¸ä¼¼æ€§ | è¿œç¨‹åŒæºæ€§åˆ†æ |
| **æ‰¹é‡å¤„ç†** | æ”¯æŒå¤§è§„æ¨¡ç»“æ„æ¯”å¯¹ | è›‹ç™½è´¨ç»„åˆ†æ |

### æ”¯æŒçš„æ•°æ®åº“ç±»å‹

- **PDBæ•°æ®åº“**ï¼šå®éªŒè§£æçš„3Dè›‹ç™½è´¨ç»“æ„
- **AlphaFoldæ•°æ®åº“**ï¼šAIé¢„æµ‹çš„è›‹ç™½è´¨ç»“æ„
- **SwissProtæ•°æ®åº“**ï¼šé«˜è´¨é‡è›‹ç™½è´¨åºåˆ—æ•°æ®åº“
- **è‡ªå®šä¹‰æ•°æ®åº“**ï¼šç”¨æˆ·æ„å»ºçš„ä¸“ä¸šç»“æ„æ•°æ®åº“

### åº”ç”¨é¢†åŸŸ

- **ç»“æ„ç”Ÿç‰©å­¦ç ”ç©¶**ï¼šè›‹ç™½è´¨æŠ˜å å’ŒåŠŸèƒ½åŸŸåˆ†æ
- **è¯ç‰©å‘ç°**ï¼šé¶ç‚¹è¯†åˆ«å’Œæ´»æ€§ä½ç‚¹æ¯”è¾ƒ
- **è¿›åŒ–ç”Ÿç‰©å­¦**ï¼šè›‹ç™½è´¨è¿›åŒ–å…³ç³»ç ”ç©¶
- **åŠŸèƒ½åŸºå› ç»„å­¦**ï¼šæœªçŸ¥è›‹ç™½åŠŸèƒ½é¢„æµ‹

---

## ğŸ¯ ä½¿ç”¨æ–¹å¼æ¦‚è§ˆ

Foldseek æä¾›ä¸¤ç§ä¸»è¦ä½¿ç”¨æ–¹å¼ï¼š

### 1. å›¾å½¢åŒ–ç•Œé¢ï¼ˆCHESSå¹³å°ï¼‰

é€šè¿‡CHESSç½‘é¡µç•Œé¢è¿›è¡Œå¯è§†åŒ–æ“ä½œï¼Œé€‚åˆåˆå­¦è€…å’Œå¶å°”ä½¿ç”¨çš„ç”¨æˆ·ã€‚

**ä¼˜ç‚¹**ï¼š
- æ“ä½œç®€å•ç›´è§‚
- æ— éœ€å‘½ä»¤è¡Œç»éªŒ
- å®æ—¶ä½œä¸šç›‘æ§
- ç»“æœå¯è§†åŒ–å±•ç¤º

**é€‚ç”¨åœºæ™¯**ï¼š
- å•ä¸ªæˆ–å°‘é‡ç»“æ„æœç´¢
- æ•™å­¦å’Œå­¦ä¹ ç”¨é€”
- å¿«é€ŸåŸå‹åˆ†æ

### 2. å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰

é€šè¿‡SSHè¿æ¥åˆ°é›†ç¾¤è¿›è¡Œæ‰¹é‡å¤„ç†å’Œè‡ªåŠ¨åŒ–åˆ†æã€‚

**ä¼˜ç‚¹**ï¼š
- é«˜æ•ˆæ‰¹é‡å¤„ç†
- è„šæœ¬è‡ªåŠ¨åŒ–
- çµæ´»å‚æ•°é…ç½®
- é€‚åˆå¤§è§„æ¨¡åˆ†æ

**é€‚ç”¨åœºæ™¯**ï¼š
- å¤§è§„æ¨¡ç»“æ„æ¯”å¯¹
- è‡ªåŠ¨åŒ–æµç¨‹
- é«˜çº§åˆ†æéœ€æ±‚

---

## ğŸ–¥ï¸ CHESSå›¾å½¢åŒ–ç•Œé¢ä½¿ç”¨

### å¹³å°è®¿é—®ä¸åº”ç”¨ä¸‹è½½

#### 1. ç™»å½•CHESSå¹³å°

é¦–å…ˆè®¿é—®CHESSå¹³å°å¹¶å®Œæˆç™»å½•è®¤è¯ã€‚

#### 2. ä¸‹è½½Foldseekåº”ç”¨

åœ¨åº”ç”¨ä¸­å¿ƒä¸­æ‰¾åˆ°å¹¶ä¸‹è½½Foldseekåº”ç”¨ï¼š

![Foldseekåº”ç”¨ä¸‹è½½](/static/guides/hpc/software-applications/foldseek/foldseek-chess-download.png)

*å›¾ï¼šåœ¨CHESSåº”ç”¨ä¸­å¿ƒä¸‹è½½Foldseekåº”ç”¨*

#### 3. åº”ç”¨å®‰è£…ä¸é…ç½®

ä¸‹è½½å®Œæˆåï¼ŒFoldseekåº”ç”¨å°†è‡ªåŠ¨å®‰è£…åˆ°æ‚¨çš„æ¡Œé¢ç¯å¢ƒä¸­ï¼Œå¯ä»¥ç›´æ¥å¯åŠ¨ä½¿ç”¨ã€‚

### ä½œä¸šæäº¤æµç¨‹

#### 1. å¯åŠ¨Foldseekåº”ç”¨

åŒå‡»æ¡Œé¢ä¸Šçš„Foldseekå›¾æ ‡ï¼Œæ‰“å¼€åº”ç”¨ç•Œé¢ã€‚

#### 2. é…ç½®æœç´¢å‚æ•°

åœ¨Foldseekç•Œé¢ä¸­é…ç½®ä»¥ä¸‹å‚æ•°ï¼š

**è¾“å…¥æ–‡ä»¶è®¾ç½®**ï¼š
- **æŸ¥è¯¢ç»“æ„**ï¼šé€‰æ‹©è¦æœç´¢çš„è›‹ç™½è´¨ç»“æ„æ–‡ä»¶ï¼ˆPDBæ ¼å¼ï¼‰
- **è¾“å‡ºç›®å½•**ï¼šè®¾ç½®ç»“æœæ–‡ä»¶çš„ä¿å­˜è·¯å¾„

**æœç´¢æ•°æ®åº“é€‰æ‹©**ï¼š
- **PDBæ•°æ®åº“**ï¼šå®éªŒè§£æç»“æ„
- **AlphaFoldæ•°æ®åº“**ï¼šé¢„æµ‹ç»“æ„
- **SwissProtæ•°æ®åº“**ï¼šåºåˆ—æ•°æ®åº“

**é«˜çº§å‚æ•°**ï¼š
- **E-valueé˜ˆå€¼**ï¼šæ§åˆ¶æœç´¢çµæ•åº¦ï¼ˆé»˜è®¤ï¼š0.001ï¼‰
- **è¦†ç›–ç‡**ï¼šæœ€å°ç»“æ„è¦†ç›–ç‡è¦æ±‚
- **æœ€å¤§ç›®æ ‡æ•°**ï¼šè¿”å›ç»“æœçš„æœ€å¤§æ•°é‡

#### 3. æäº¤ä½œä¸š

å‚æ•°é…ç½®å®Œæˆåï¼Œç‚¹å‡»"æäº¤ä½œä¸š"æŒ‰é’®ï¼š

![Foldseekä½œä¸šæäº¤](/static/guides/hpc/software-applications/foldseek/foldseek-job-submit.png)

*å›¾ï¼šFoldseekä½œä¸šæäº¤ç•Œé¢*

### ä½œä¸šç›‘æ§ä¸ç®¡ç†

#### 1. æŸ¥çœ‹ä½œä¸šçŠ¶æ€

æäº¤åå¯åœ¨ä½œä¸šç®¡ç†ç•Œé¢æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ï¼š

![Foldseekä½œä¸šçŠ¶æ€](/static/guides/hpc/software-applications/foldseek/foldseek-job-status.png)

*å›¾ï¼šä½œä¸šçŠ¶æ€ç›‘æ§ç•Œé¢*

#### 2. ä½œä¸šçŠ¶æ€è¯´æ˜

| çŠ¶æ€ | æè¿° | å¤„ç†å»ºè®® |
|------|-----|----------|
| **é˜Ÿåˆ—ä¸­** | ä½œä¸šç­‰å¾…è°ƒåº¦ | è€å¿ƒç­‰å¾…ï¼Œå¯æŸ¥çœ‹é˜Ÿåˆ—é•¿åº¦ |
| **è¿è¡Œä¸­** | æ­£åœ¨æ‰§è¡Œæœç´¢ | ç›‘æ§è¿›åº¦ï¼Œå¤§å‹æœç´¢å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ |
| **å·²å®Œæˆ** | æœç´¢æˆåŠŸå®Œæˆ | ä¸‹è½½å¹¶åˆ†æç»“æœæ–‡ä»¶ |
| **å¤±è´¥** | ä½œä¸šæ‰§è¡Œå‡ºé”™ | æ£€æŸ¥è¾“å…¥æ–‡ä»¶å’Œå‚æ•°è®¾ç½® |

---

## ğŸ’» å‘½ä»¤è¡Œç•Œé¢ä½¿ç”¨

### ç¯å¢ƒå‡†å¤‡

#### 1. è¿æ¥åˆ°é›†ç¾¤

```bash title="SSHè¿æ¥åˆ°é›†ç¾¤"
ssh your_username@cluster.domain.com
```

#### 2. åŠ è½½Foldseekæ¨¡å—

```bash title="æ¨¡å—ç¯å¢ƒé…ç½®"
# æŸ¥çœ‹å¯ç”¨çš„Foldseekç‰ˆæœ¬
module avail foldseek

# åŠ è½½Foldseekæ¨¡å—
module load foldseek/latest

# éªŒè¯å®‰è£…
foldseek --help
```

#### 3. æ•°æ®åº“å‡†å¤‡

```bash title="æ•°æ®åº“ä¸‹è½½ä¸å‡†å¤‡"
# åˆ›å»ºæ•°æ®åº“ç›®å½•
mkdir -p ~/foldseek_databases

# ä¸‹è½½é¢„æ„å»ºæ•°æ®åº“
cd ~/foldseek_databases

# AlphaFoldæ•°æ®åº“
wget https://mmseqs.com/foldseek/afdb_proteome.tar.gz
tar xzf afdb_proteome.tar.gz

# PDBæ•°æ®åº“
wget https://mmseqs.com/foldseek/pdb100.tar.gz
tar xzf pdb100.tar.gz
```

### åŸºç¡€æœç´¢æ“ä½œ

#### 1. ç®€å•ç»“æ„æœç´¢

```bash title="åŸºæœ¬æœç´¢å‘½ä»¤"
# å¯¹å•ä¸ªPDBæ–‡ä»¶è¿›è¡Œæœç´¢
foldseek search \
    query.pdb \
    ~/foldseek_databases/afdb_proteome \
    result.m8 \
    tmp/ \
    --format-output "query,target,pident,alnlen,mismatch,gapopen,qstart,qend,tstart,tend,evalue,bits"
```

#### 2. æ‰¹é‡ç»“æ„æœç´¢

```bash title="æ‰¹é‡æœç´¢è„šæœ¬ (batch_search.sh)"
#!/bin/bash

# è¾“å…¥ç›®å½•åŒ…å«å¤šä¸ªPDBæ–‡ä»¶
input_dir="./pdb_structures"
database="~/foldseek_databases/afdb_proteome"
output_dir="./foldseek_results"

# åˆ›å»ºè¾“å‡ºç›®å½•
mkdir -p $output_dir

# æ‰¹é‡å¤„ç†
for pdb_file in $input_dir/*.pdb; do
    filename=$(basename "$pdb_file" .pdb)
    echo "Processing $filename..."
    
    foldseek search \
        $pdb_file \
        $database \
        $output_dir/${filename}_results.m8 \
        $output_dir/${filename}_tmp/ \
        --threads 8 \
        -e 0.001 \
        --format-output "query,target,pident,alnlen,evalue,bits,qcov,tcov"
    
    echo "Completed: $filename"
done

echo "æ‰¹é‡æœç´¢å®Œæˆï¼"
```

#### 3. é«˜çº§æœç´¢å‚æ•°

```bash title="é«˜çº§å‚æ•°é…ç½®"
foldseek search \
    query.pdb \
    database \
    results.m8 \
    tmp/ \
    --threads 16 \                    # å¹¶è¡Œçº¿ç¨‹æ•°
    -e 0.001 \                        # E-valueé˜ˆå€¼
    --min-seq-id 0.3 \                # æœ€å°åºåˆ—åŒä¸€æ€§
    -c 0.8 \                          # æœ€å°è¦†ç›–ç‡
    --cov-mode 1 \                    # è¦†ç›–ç‡è®¡ç®—æ¨¡å¼
    --max-seqs 1000 \                 # æœ€å¤§è¿”å›åºåˆ—æ•°
    --format-output "query,target,pident,alnlen,mismatch,gapopen,qstart,qend,tstart,tend,evalue,bits,qcov,tcov"
```

### SLURMä½œä¸šæäº¤

#### 1. å•ä¸ªæœç´¢ä½œä¸š

```bash title="SLURMæäº¤è„šæœ¬ (submit_foldseek.sh)"
#!/bin/bash
#SBATCH --job-name=foldseek_search
#SBATCH --partition=qcpu_18i
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=16
#SBATCH --mem=64GB
#SBATCH --time=12:00:00
#SBATCH --output=foldseek_%j.out
#SBATCH --error=foldseek_%j.err

# ç¯å¢ƒè®¾ç½®
module load foldseek/latest

# æ˜¾ç¤ºä½œä¸šä¿¡æ¯
echo "ä½œä¸šå¼€å§‹æ—¶é—´: $(date)"
echo "ä½œä¸šID: $SLURM_JOB_ID"
echo "è®¡ç®—èŠ‚ç‚¹: $SLURM_JOB_NODELIST"

# æ‰§è¡ŒFoldseekæœç´¢
foldseek search \
    $1 \
    ~/foldseek_databases/afdb_proteome \
    ${1%.pdb}_afdb_results.m8 \
    tmp_${SLURM_JOB_ID}/ \
    --threads $SLURM_NTASKS \
    -e 0.001 \
    --format-output "query,target,pident,alnlen,evalue,bits,qcov,tcov"

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm -rf tmp_${SLURM_JOB_ID}/

echo "ä½œä¸šå®Œæˆæ—¶é—´: $(date)"
```

#### 2. æäº¤ä½œä¸š

```bash title="ä½œä¸šæäº¤å‘½ä»¤"
# æäº¤å•ä¸ªæœç´¢ä½œä¸š
sbatch submit_foldseek.sh query_protein.pdb

# æŸ¥çœ‹ä½œä¸šçŠ¶æ€
squeue -u $USER

# æŸ¥çœ‹ä½œä¸šè¾“å‡º
tail -f foldseek_*.out
```

#### 3. æ‰¹é‡ä½œä¸šæäº¤

```bash title="æ‰¹é‡æäº¤è„šæœ¬"
#!/bin/bash

# æ‰¹é‡æäº¤å¤šä¸ªPDBæ–‡ä»¶çš„æœç´¢ä½œä¸š
pdb_directory="./input_structures"

for pdb_file in $pdb_directory/*.pdb; do
    if [[ -f "$pdb_file" ]]; then
        echo "æäº¤ä½œä¸š: $(basename $pdb_file)"
        sbatch submit_foldseek.sh $pdb_file
        sleep 2  # é¿å…åŒæ—¶æäº¤è¿‡å¤šä½œä¸š
    fi
done

echo "æ‰€æœ‰ä½œä¸šå·²æäº¤å®Œæˆ"
```

---

## ğŸ“Š ç»“æœåˆ†æä¸è§£è¯»

### è¾“å‡ºæ–‡ä»¶æ ¼å¼

#### 1. æœç´¢ç»“æœæ–‡ä»¶

Foldseekæœç´¢å®Œæˆåç”Ÿæˆä»¥ä¸‹ç±»å‹çš„è¾“å‡ºæ–‡ä»¶ï¼š

```bash title="å…¸å‹è¾“å‡ºæ–‡ä»¶ç»“æ„"
# CHESSç•Œé¢è¾“å‡ºç¤ºä¾‹
AF-A7MCY6-F1-model_v4-afdb_proteome_aln.tsv    # AlphaFoldæ•°æ®åº“æœç´¢ç»“æœ
AF-A7MCY6-F1-model_v4-afdb_swissprot_aln.tsv   # SwissProtæ•°æ®åº“æœç´¢ç»“æœ  
AF-A7MCY6-F1-model_v4-pdb_aln.tsv              # PDBæ•°æ®åº“æœç´¢ç»“æœ
AF-A7MCY6-F1-model_v4.pdb                      # æŸ¥è¯¢ç»“æ„æ–‡ä»¶
```

#### 2. ç»“æœæ–‡ä»¶å­—æ®µè¯´æ˜

| å­—æ®µåç§° | æè¿° | ç¤ºä¾‹å€¼ |
|---------|-----|--------|
| **query** | æŸ¥è¯¢ç»“æ„æ ‡è¯†ç¬¦ | AF-A7MCY6-F1-model_v4 |
| **target** | ç›®æ ‡ç»“æ„æ ‡è¯†ç¬¦ | AF-P12345-F1-model_v4 |
| **pident** | åºåˆ—åŒä¸€æ€§ç™¾åˆ†æ¯” | 85.4 |
| **alnlen** | æ¯”å¯¹é•¿åº¦ | 256 |
| **evalue** | æœŸæœ›å€¼ | 1.2e-45 |
| **bits** | æ¯”ç‰¹å¾—åˆ† | 187.3 |
| **qcov** | æŸ¥è¯¢è¦†ç›–ç‡ | 0.92 |
| **tcov** | ç›®æ ‡è¦†ç›–ç‡ | 0.88 |

### ç»“æœè´¨é‡è¯„ä¼°

#### 1. æ˜¾è‘—æ€§é˜ˆå€¼

```bash title="ç»“æœè¿‡æ»¤æ ‡å‡†"
# é«˜ç½®ä¿¡åº¦åŒ¹é…
E-value < 1e-10
Bit score > 100
Query coverage > 0.8

# ä¸­ç­‰ç½®ä¿¡åº¦åŒ¹é…  
E-value < 1e-5
Bit score > 50
Query coverage > 0.6

# ä½ç½®ä¿¡åº¦åŒ¹é…ï¼ˆéœ€è¦äººå·¥éªŒè¯ï¼‰
E-value < 0.01
Bit score > 30
Query coverage > 0.4
```

#### 2. ç»“æœæ’åºä¸ç­›é€‰

```bash title="ç»“æœå¤„ç†è„šæœ¬"
#!/bin/bash

# æŒ‰E-valueæ’åºå¹¶ç­›é€‰é«˜è´¨é‡åŒ¹é…
awk '$11 < 1e-5 && $13 > 0.7' results.m8 | \
sort -k11,11g > high_quality_matches.tsv

# ç»Ÿè®¡åŒ¹é…æ•°é‡
echo "é«˜è´¨é‡åŒ¹é…æ•°é‡: $(wc -l < high_quality_matches.tsv)"

# æå–æœ€ä½³åŒ¹é…
head -10 high_quality_matches.tsv > top10_matches.tsv
```

### ç»“æœå¯è§†åŒ–ä¸åˆ†æ

#### 1. Pythonåˆ†æè„šæœ¬

```python title="ç»“æœåˆ†æè„šæœ¬ (analyze_results.py)"
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# è¯»å–æœç´¢ç»“æœ
def load_foldseek_results(filepath):
    columns = ['query', 'target', 'pident', 'alnlen', 'mismatch', 
               'gapopen', 'qstart', 'qend', 'tstart', 'tend', 
               'evalue', 'bits', 'qcov', 'tcov']
    
    df = pd.read_csv(filepath, sep='\t', names=columns)
    return df

# åˆ†æç»“æœè´¨é‡åˆ†å¸ƒ
def analyze_search_quality(df):
    fig, axes = plt.subplots(2, 2, figsize=(12, 10))
    
    # E-valueåˆ†å¸ƒ
    axes[0,0].hist(df['evalue'], bins=50, alpha=0.7)
    axes[0,0].set_xlabel('E-value')
    axes[0,0].set_ylabel('é¢‘æ¬¡')
    axes[0,0].set_title('E-valueåˆ†å¸ƒ')
    axes[0,0].set_yscale('log')
    
    # åºåˆ—åŒä¸€æ€§åˆ†å¸ƒ
    axes[0,1].hist(df['pident'], bins=30, alpha=0.7, color='green')
    axes[0,1].set_xlabel('åºåˆ—åŒä¸€æ€§ (%)')
    axes[0,1].set_ylabel('é¢‘æ¬¡')
    axes[0,1].set_title('åºåˆ—åŒä¸€æ€§åˆ†å¸ƒ')
    
    # æŸ¥è¯¢è¦†ç›–ç‡åˆ†å¸ƒ
    axes[1,0].hist(df['qcov'], bins=30, alpha=0.7, color='orange')
    axes[1,0].set_xlabel('æŸ¥è¯¢è¦†ç›–ç‡')
    axes[1,0].set_ylabel('é¢‘æ¬¡')
    axes[1,0].set_title('æŸ¥è¯¢è¦†ç›–ç‡åˆ†å¸ƒ')
    
    # æ¯”ç‰¹å¾—åˆ†åˆ†å¸ƒ
    axes[1,1].hist(df['bits'], bins=40, alpha=0.7, color='red')
    axes[1,1].set_xlabel('æ¯”ç‰¹å¾—åˆ†')
    axes[1,1].set_ylabel('é¢‘æ¬¡')
    axes[1,1].set_title('æ¯”ç‰¹å¾—åˆ†åˆ†å¸ƒ')
    
    plt.tight_layout()
    plt.savefig('foldseek_analysis.png', dpi=300)
    plt.show()

# ä¸»åˆ†ææµç¨‹
if __name__ == "__main__":
    # åŠ è½½ç»“æœ
    results = load_foldseek_results('results.m8')
    
    print(f"æ€»åŒ¹é…æ•°é‡: {len(results)}")
    print(f"é«˜è´¨é‡åŒ¹é…æ•°é‡ (E-value < 1e-5): {sum(results['evalue'] < 1e-5)}")
    print(f"å¹³å‡åºåˆ—åŒä¸€æ€§: {results['pident'].mean():.2f}%")
    print(f"å¹³å‡æŸ¥è¯¢è¦†ç›–ç‡: {results['qcov'].mean():.3f}")
    
    # ç”Ÿæˆåˆ†æå›¾è¡¨
    analyze_search_quality(results)
```

---

## âš ï¸ å¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤

### æœç´¢ç»“æœé—®é¢˜

<details>
<summary><strong>æœç´¢ç»“æœä¸ºç©ºæˆ–å¾ˆå°‘</strong></summary>

**åŸå› åˆ†æ**ï¼š
- E-valueé˜ˆå€¼è®¾ç½®è¿‡ä¸¥æ ¼
- æŸ¥è¯¢ç»“æ„è´¨é‡é—®é¢˜
- æ•°æ®åº“é€‰æ‹©ä¸å½“

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ”¾å®½æœç´¢å‚æ•°
foldseek search query.pdb database results.m8 tmp/ \
    -e 0.1 \           # å¢å¤§E-valueé˜ˆå€¼
    -c 0.5 \           # é™ä½è¦†ç›–ç‡è¦æ±‚
    --max-seqs 10000   # å¢åŠ æœ€å¤§è¿”å›æ•°é‡
```
</details>

<details>
<summary><strong>å†…å­˜ä¸è¶³é”™è¯¯</strong></summary>

**é”™è¯¯è¡¨ç°**ï¼šå†…å­˜æº¢å‡ºã€ç¨‹åºå¼‚å¸¸ç»ˆæ­¢

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å¢åŠ å†…å­˜ç”³è¯·
#SBATCH --mem=128GB

# æˆ–ä½¿ç”¨å†…å­˜ä¼˜åŒ–å‚æ•°
foldseek search query.pdb database results.m8 tmp/ \
    --split-memory-limit 32G
```
</details>

### æ€§èƒ½ä¼˜åŒ–é—®é¢˜

<details>
<summary><strong>æœç´¢é€Ÿåº¦æ…¢</strong></summary>

**ä¼˜åŒ–ç­–ç•¥**ï¼š

1. **å¢åŠ å¹¶è¡Œåº¦**ï¼š
   ```bash
   --threads 32  # æ ¹æ®å¯ç”¨CPUæ ¸å¿ƒæ•°è°ƒæ•´
   ```

2. **ä½¿ç”¨SSDå­˜å‚¨**ï¼š
   ```bash
   # å°†ä¸´æ—¶ç›®å½•è®¾ç½®åœ¨å¿«é€Ÿå­˜å‚¨ä¸Š
   export TMPDIR=/fast_ssd/tmp
   ```

3. **æ•°æ®åº“é¢„å¤„ç†**ï¼š
   ```bash
   # ç¡®ä¿æ•°æ®åº“å·²æ­£ç¡®ç´¢å¼•
   foldseek createdb input.fasta database
   ```
</details>

### æ•°æ®åº“ç›¸å…³é—®é¢˜

<details>
<summary><strong>æ•°æ®åº“ä¸‹è½½å¤±è´¥</strong></summary>

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä½¿ç”¨é•œåƒæœåŠ¡å™¨
wget https://mirror.mmseqs.com/foldseek/afdb_proteome.tar.gz

# æˆ–åˆ†å—ä¸‹è½½
wget -c --tries=0 --read-timeout=20 url

# éªŒè¯æ–‡ä»¶å®Œæ•´æ€§
md5sum -c database.md5
```
</details>

---

## ğŸ“ˆ é«˜çº§åº”ç”¨ä¸æœ€ä½³å®è·µ

### å¤§è§„æ¨¡æ¯”è¾ƒåˆ†æ

#### 1. è›‹ç™½è´¨å®¶æ—åˆ†æ

```bash title="è›‹ç™½è´¨å®¶æ—èšç±»åˆ†æ"
# æ„å»ºè›‹ç™½è´¨å®¶æ—æ•°æ®åº“
foldseek createdb family_structures.fasta family_db

# è¿›è¡Œall-vs-allæ¯”è¾ƒ
foldseek search family_db family_db results.m8 tmp/ \
    --threads 16 -e 0.001

# èšç±»åˆ†æ
foldseek cluster family_db cluster_result tmp/ \
    --min-seq-id 0.3 -c 0.8

# ç”Ÿæˆèšç±»æŠ¥å‘Š
foldseek createtsv family_db family_db cluster_result cluster_report.tsv
```

#### 2. ç»“æ„åŸŸæ³¨é‡Šæµæ°´çº¿

```bash title="è‡ªåŠ¨åŒ–ç»“æ„åŸŸæ³¨é‡Š"
#!/bin/bash

# 1. ç»“æ„åŸŸæ•°æ®åº“æœç´¢
foldseek search query.pdb pfam_structures results_pfam.m8 tmp/

# 2. åŠŸèƒ½åŸŸè¯†åˆ«
python identify_domains.py results_pfam.m8 > domain_annotation.txt

# 3. ç”Ÿæˆæ³¨é‡ŠæŠ¥å‘Š
generate_annotation_report.py \
    --input domain_annotation.txt \
    --output detailed_report.html
```

### ä¸å…¶ä»–å·¥å…·çš„æ•´åˆ

#### 1. ä¸AlphaFoldç»“æ„é¢„æµ‹ç»“åˆ

```bash title="AlphaFoldç»“æ„éªŒè¯æµç¨‹"
# ä¸‹è½½AlphaFoldé¢„æµ‹ç»“æ„
wget "https://alphafold.ebi.ac.uk/files/AF-${UNIPROT_ID}-F1-model_v4.pdb"

# æœç´¢ç›¸ä¼¼ç»“æ„
foldseek search AF-${UNIPROT_ID}-F1-model_v4.pdb \
    ~/databases/pdb100 \
    validation_results.m8 tmp/

# ç»“æ„è´¨é‡è¯„ä¼°
python validate_structure_quality.py \
    AF-${UNIPROT_ID}-F1-model_v4.pdb \
    validation_results.m8
```

#### 2. ä¸åˆ†å­å¯¹æ¥è½¯ä»¶åä½œ

```bash title="ç»“æ„æœç´¢è¾…åŠ©åˆ†å­å¯¹æ¥"
# 1. æœç´¢ç›¸ä¼¼æ´»æ€§ä½ç‚¹
foldseek search binding_site.pdb enzyme_database matches.m8 tmp/

# 2. æå–é«˜ç›¸ä¼¼æ€§ç»“æ„
extract_top_matches.py matches.m8 --top 10

# 3. å‡†å¤‡åˆ†å­å¯¹æ¥è¾“å…¥
prepare_docking_inputs.py top_matches.txt
```

---

## ğŸ“š æ‰©å±•èµ„æºä¸å·¥å…·

### å­¦ä¹ èµ„æº

1. **å®˜æ–¹æ–‡æ¡£**
   - [Foldseek GitHubä»“åº“](https://github.com/deepmind/foldseek)
   - [MMseqs2æ–‡æ¡£](https://mmseqs.com/latest/userguide.pdf)

2. **æ•™ç¨‹èµ„æº**
   - [ç»“æ„æ¯”å¯¹åŸç†æ•™ç¨‹](https://example.com/structure-alignment)
   - [è›‹ç™½è´¨ç»“æ„æ•°æ®åº“æŒ‡å—](https://example.com/structure-databases)

3. **ç¤¾åŒºæ”¯æŒ**
   - [Foldseekç”¨æˆ·è®ºå›](https://groups.google.com/g/mmseqs)
   - [ç»“æ„ç”Ÿç‰©å­¦ç¤¾åŒº](https://www.ccpbx.ac.uk/)

### ç›¸å…³åˆ†æå·¥å…·

| å·¥å…·åç§° | åŠŸèƒ½æè¿° | é…åˆä½¿ç”¨ |
|---------|----------|----------|
| **PyMOL** | åˆ†å­å¯è§†åŒ– | ç»“æ„å±•ç¤ºã€æ¯”å¯¹å¯è§†åŒ– |
| **ChimeraX** | é«˜çº§åˆ†å­å¯è§†åŒ– | å¤æ‚ç»“æ„åˆ†æ |
| **Bio3D** | Rè¯­è¨€ç»“æ„åˆ†æ | ç»Ÿè®¡åˆ†æã€ç½‘ç»œåˆ†æ |
| **MDAnalysis** | åˆ†å­åŠ¨åŠ›å­¦åˆ†æ | åŠ¨æ€ç»“æ„åˆ†æ |

### æ•°æ®åº“èµ„æº

| æ•°æ®åº“åç§° | æè¿° | æ›´æ–°é¢‘ç‡ | è·å–æ–¹å¼ |
|-----------|-----|----------|----------|
| **PDB** | å®éªŒè§£æç»“æ„ | æ¯å‘¨ | https://www.rcsb.org/ |
| **AlphaFold DB** | AIé¢„æµ‹ç»“æ„ | å®šæœŸ | https://alphafold.ebi.ac.uk/ |
| **SCOP** | ç»“æ„åˆ†ç±»æ•°æ®åº“ | å¹´åº¦ | https://scop.berkeley.edu/ |
| **CATH** | è›‹ç™½è´¨ç»“æ„å±‚æ¬¡ | å®šæœŸ | https://www.cathdb.info/ |

---

## ğŸ¬ å®é™…æ“ä½œæ¼”ç¤º

### å®Œæ•´æœç´¢æµç¨‹æ¼”ç¤º

è§‚çœ‹ä¸‹æ–¹åŠ¨å›¾äº†è§£å®Œæ•´çš„Foldseekç»“æ„æœç´¢æµç¨‹ï¼Œä»CHESSç•Œé¢æ“ä½œåˆ°ç»“æœåˆ†æï¼š

![Foldseekä½¿ç”¨æ¼”ç¤º](/static/guides/hpc/software-applications/foldseek/foldseek.gif)

*æ¼”ç¤ºå†…å®¹åŒ…æ‹¬ï¼šCHESSç™»å½• â†’ åº”ç”¨ä¸‹è½½ â†’ ä½œä¸šé…ç½® â†’ æäº¤æ‰§è¡Œ â†’ çŠ¶æ€ç›‘æ§ â†’ ç»“æœæŸ¥çœ‹*

### å®è·µå­¦ä¹ è·¯å¾„

1. **åˆå­¦è€…ç»ƒä¹ **ï¼šä½¿ç”¨CHESSç•Œé¢è¿›è¡Œå•ä¸ªç»“æ„æœç´¢
2. **è¿›é˜¶ç»ƒä¹ **ï¼šå‘½ä»¤è¡Œæ‰¹é‡å¤„ç†å’Œå‚æ•°ä¼˜åŒ–
3. **é«˜çº§åº”ç”¨**ï¼šæ•´åˆåˆ†ææµæ°´çº¿å’Œè‡ªåŠ¨åŒ–è„šæœ¬

---

## ğŸ’¡ æœ€ä½³å®è·µæ€»ç»“

:::tip å…³é”®è¦ç‚¹
1. **åˆç†é€‰æ‹©æ•°æ®åº“**ï¼šæ ¹æ®ç ”ç©¶ç›®çš„é€‰æ‹©åˆé€‚çš„ç»“æ„æ•°æ®åº“
2. **å‚æ•°ä¼˜åŒ–**ï¼šæ ¹æ®ç»“æ„ç‰¹ç‚¹è°ƒæ•´æœç´¢å‚æ•°ä»¥è·å¾—æœ€ä½³ç»“æœ
3. **ç»“æœéªŒè¯**ï¼šä½¿ç”¨å¤šç§æŒ‡æ ‡è¯„ä¼°æœç´¢ç»“æœçš„å¯é æ€§  
4. **æ‰¹é‡å¤„ç†**ï¼šåˆ©ç”¨é›†ç¾¤èµ„æºè¿›è¡Œå¤§è§„æ¨¡ç»“æ„æ¯”è¾ƒåˆ†æ
5. **ç»“æœæ•´åˆ**ï¼šå°†Foldseekç»“æœä¸å…¶ä»–ç”Ÿç‰©ä¿¡æ¯å­¦å·¥å…·ç»“åˆåˆ†æ
:::

:::warning æ³¨æ„äº‹é¡¹
- å¤§è§„æ¨¡æœç´¢éœ€è¦å……åˆ†çš„å­˜å‚¨ç©ºé—´å’Œè®¡ç®—èµ„æº
- æ•°æ®åº“æ–‡ä»¶è¾ƒå¤§ï¼Œå»ºè®®ä½¿ç”¨é«˜é€Ÿç½‘ç»œä¸‹è½½
- ç»“æœè§£è¯»éœ€è¦ç»“åˆç”Ÿç‰©å­¦èƒŒæ™¯çŸ¥è¯†
- å®šæœŸæ›´æ–°æ•°æ®åº“ä»¥è·å¾—æœ€æ–°çš„ç»“æ„ä¿¡æ¯
:::

---

<head>
  <title>Foldseek è›‹ç™½è´¨ç»“æ„æœç´¢å¹³å°ä½¿ç”¨æŒ‡å— | HPCå¹³å°æ–‡æ¡£</title>
  <meta
    name="description"
    content="å…¨é¢çš„Foldseekè›‹ç™½è´¨ç»“æ„æœç´¢å·¥å…·ä½¿ç”¨æŒ‡å—ï¼Œæ¶µç›–å›¾å½¢åŒ–ç•Œé¢å’Œå‘½ä»¤è¡Œä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼ŒåŒ…å«ç»“æ„æ¯”å¯¹ã€æ•°æ®åº“æœç´¢å’Œç»“æœåˆ†æçš„å®Œæ•´æµç¨‹ã€‚"
  />
  <meta name="keywords" content="Foldseek, è›‹ç™½è´¨ç»“æ„, ç»“æ„æ¯”å¯¹, ç»“æ„æœç´¢, AlphaFold, PDB, ç»“æ„ç”Ÿç‰©å­¦" />
</head> 